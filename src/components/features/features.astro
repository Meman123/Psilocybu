---
// src/components/Features.astro
import { Image } from 'astro:assets';
import growkitImage from '@/assets/growkit-psilocybu.png';
---

<style>
/* — Bloque principal */
.features{
  background:var(--color-background);
  padding-block:var(--spacing-xl);
}

/* — Grid */
.features__container{
  max-width:var(--site-max-width);
  margin-inline:auto;
  padding-inline:var(--side-gutter);
  display:grid;
  gap:var(--spacing-xl);
  grid-template-columns:1fr;
}

/* — Columnas */
.features__text{
  display:flex;
  flex-direction:column;
  gap:var(--spacing-lg);
  text-align:center;
}
.features__product{
  --product-col-width:400px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:var(--spacing-lg);
}

/* — Tipografía y lista */
.headline{
  font:clamp(2rem,4vw,3.5rem)/1.1 var(--font-family-headings,'Quicksand');
  font-weight:700;
  filter:drop-shadow(-1px 2px .1px hsla(0, 0%, 0%, 0.8));
}
.headline .highlight{color:var(--color-accent);}

.features-list{
  list-style:none;
  padding:0;
  display:flex;
  flex-direction:column;
  gap:12px;
  margin-inline:auto;
  align-items:center;
}
.feature-item{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:500;
  font-size:1.2rem;
}
.feature-item::before{
  content:"";
  flex-shrink:0;
  width:7px;
  height:7px;
  border-radius:50%;
  background:var(--color-accent);
}

/* — Badge */
.badge{
  display:inline-block;
  background:var(--color-accent);
  color:#000;
  font-weight:600;
  padding:4px 12px;
  border-radius:8px;
  font-size:.95rem;
  box-shadow:0 1px 4px rgb(0 0 0/.12);
}
.badge-shipping{margin-bottom:8px;}

/* — Imagen */
.product-img{
  width:100%;
  max-width:var(--product-col-width);
}
.product-img :global(img){
  display:block;
  width:100%;
  height:auto;
}

/* — Botones */
.cta-buttons{
  display:flex;
  flex-direction:column;
  gap:8px;
  width:100%;
  max-width:var(--product-col-width);
}
.btn{
  flex:1;
  padding-block:12px;
  border-radius:12px;
  font:600 1rem/1 var(--font-family-headings,'Quicksand');
  display:flex;
  justify-content:center;
  align-items:center;
  box-shadow:0 3px 6px rgb(0 0 0/.5);
  transition:transform .25s ease;
  text-align:center;
}
.btn:hover{transform:scale(1.05);}
.btn:focus-visible{
  outline:3px solid var(--color-accent);
  outline-offset:3px;
}
.btn-primary{
  background:var(--color-accent);
  color:#000;
}
.btn-secondary{
  background:#fff;
  color:#000;
}

/* — Responsive */
@media (min-width:900px){
  .features__container{
    grid-template-columns:1.2fr 1fr;
    align-items:center;
  }
  .features__text{text-align:left;}
  .cta-buttons{flex-direction:row;}
  .features-list{
    margin-inline:0;
    align-items:flex-start;
    display:grid;
    grid-template-columns:1fr 1fr; /* dos columnas de bullets */
    gap:12px 48px;
  }
}

@media (max-width:500px){
  .feature-item{font-size:1.05rem;}
}
</style>

<section class="features" id="features">
  ...
  <div class="cta-buttons">
    <a href="#" id="btn-comprar-growkit" class="btn btn-primary">Compra tu GrowKit</a>
    <a href="#" class="btn btn-secondary">¿Cómo funciona?</a>
  </div>
  ...
  <script is:inline>
    document.addEventListener("DOMContentLoaded", function() {
      const btn = document.getElementById('btn-comprar-growkit');
      if (!btn) return;
      btn.addEventListener('click', async function(event) {
        event.preventDefault();
        btn.textContent = "Redirigiendo...";
        btn.disabled = true;
        try {
          const res = await fetch('https://api.yieldworks.com.co/webhook/preferencia-growkit');
          const data = await res.json();
          if (data.init_point) {
            window.location.href = data.init_point;
          } else {
            btn.textContent = "Intenta de nuevo";
            btn.disabled = false;
            alert("No se pudo obtener el enlace de pago. Intenta más tarde.");
          }
        } catch (error) {
          btn.textContent = "Intenta de nuevo";
          btn.disabled = false;
          alert("Error al conectar con el servidor.");
        }
      });
    });
  </script>
</section>

